# Comment Ã‡a Marche - En Images

## Principe Simple

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                â”‚
â”‚  VOTRE FICHIER WORD                                            â”‚
â”‚  avec logo, tableaux, mise en forme                            â”‚
â”‚                                                                â”‚
â”‚  Bonjour {{nom}}, votre poste est {{poste}}                    â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                    [UPLOAD]
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                â”‚
â”‚  STOCKÃ‰ TEL QUEL dans Supabase                                 â”‚
â”‚  Aucune modification                                           â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                    [GÃ‰NÃ‰RATION]
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                â”‚
â”‚  1. TÃ©lÃ©charger le fichier ORIGINAL                            â”‚
â”‚  2. Chercher {{nom}} et {{poste}}                              â”‚
â”‚  3. Remplacer par "DUPONT" et "Chauffeur"                      â”‚
â”‚  4. Sauvegarder le rÃ©sultat                                    â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                    [RÃ‰SULTAT]
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                â”‚
â”‚  VOTRE FICHIER WORD                                            â”‚
â”‚  avec logo, tableaux, mise en forme                            â”‚
â”‚  (IDENTIQUE)                                                   â”‚
â”‚                                                                â”‚
â”‚  Bonjour DUPONT, votre poste est Chauffeur                     â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Exemple Visuel Complet

### AVANT (Votre ModÃ¨le)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                               â•‘
â•‘  [LOGO TCA]                         TRANSPORT CLASSE AFFAIRE  â•‘
â•‘                                     111 Avenue Victor Hugo    â•‘
â•‘                                     75116 Paris               â•‘
â•‘                                                               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                               â•‘
â•‘                      CONVOCATION                              â•‘
â•‘                                                               â•‘
â•‘  Paris, le {{date_aujourd_hui}}                               â•‘
â•‘                                                               â•‘
â•‘  {{civilite}} {{nom}},                                        â•‘
â•‘                                                               â•‘
â•‘  Nous avons le plaisir de vous informer que vous Ãªtes        â•‘
â•‘  convoquÃ©(e) Ã  une rÃ©union concernant votre poste de         â•‘
â•‘  {{poste}} sur le site de {{site_nom}}.                      â•‘
â•‘                                                               â•‘
â•‘  Cette rÃ©union aura lieu le {{date_reunion}}.                â•‘
â•‘                                                               â•‘
â•‘  Veuillez confirmer votre prÃ©sence avant le                  â•‘
â•‘  {{date_limite_confirmation}}.                                â•‘
â•‘                                                               â•‘
â•‘  Cordialement,                                                â•‘
â•‘                                                               â•‘
â•‘  {{nom_signataire}}                                           â•‘
â•‘  {{fonction_signataire}}                                      â•‘
â•‘                                                               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                               â•‘
â•‘  TRANSPORT CLASSE AFFAIRE - SIRET: 50426507500029            â•‘
â•‘  TÃ©l: 01.86.22.24.00 - www.tca.fr                            â•‘
â•‘                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### APRÃˆS (Document GÃ©nÃ©rÃ©)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                               â•‘
â•‘  [LOGO TCA]                         TRANSPORT CLASSE AFFAIRE  â•‘
â•‘                                     111 Avenue Victor Hugo    â•‘
â•‘                                     75116 Paris               â•‘
â•‘                                                               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                               â•‘
â•‘                      CONVOCATION                              â•‘
â•‘                                                               â•‘
â•‘  Paris, le 06/12/2025                                         â•‘
â•‘                                                               â•‘
â•‘  Monsieur DUPONT,                                             â•‘
â•‘                                                               â•‘
â•‘  Nous avons le plaisir de vous informer que vous Ãªtes        â•‘
â•‘  convoquÃ©(e) Ã  une rÃ©union concernant votre poste de         â•‘
â•‘  Chauffeur sur le site de Paris Charles de Gaulle.           â•‘
â•‘                                                               â•‘
â•‘  Cette rÃ©union aura lieu le 15/01/2025.                      â•‘
â•‘                                                               â•‘
â•‘  Veuillez confirmer votre prÃ©sence avant le                  â•‘
â•‘  10/01/2025.                                                  â•‘
â•‘                                                               â•‘
â•‘  Cordialement,                                                â•‘
â•‘                                                               â•‘
â•‘  Marie MARTIN                                                 â•‘
â•‘  Direction des Ressources Humaines                            â•‘
â•‘                                                               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                               â•‘
â•‘  TRANSPORT CLASSE AFFAIRE - SIRET: 50426507500029            â•‘
â•‘  TÃ©l: 01.86.22.24.00 - www.tca.fr                            â•‘
â•‘                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Ce Qui Change

```
{{date_aujourd_hui}}                â†’  06/12/2025
{{civilite}}                        â†’  Monsieur
{{nom}}                             â†’  DUPONT
{{poste}}                           â†’  Chauffeur
{{site_nom}}                        â†’  Paris Charles de Gaulle
{{date_reunion}}                    â†’  15/01/2025
{{date_limite_confirmation}}        â†’  10/01/2025
{{nom_signataire}}                  â†’  Marie MARTIN
{{fonction_signataire}}             â†’  Direction des Ressources Humaines
```

### Ce Qui NE Change PAS

```
âœ… Logo TCA
âœ… En-tÃªte (nom entreprise, adresse)
âœ… Mise en forme du titre "CONVOCATION"
âœ… Cadres et bordures
âœ… Police de caractÃ¨res
âœ… Taille et style du texte
âœ… Espacement des paragraphes
âœ… Pied de page
âœ… NumÃ©rotation
âœ… Tableaux
âœ… Images
```

---

## Flux Utilisateur RH

### 1. CrÃ©er le ModÃ¨le Word (Une Fois)

```
Word sur votre ordinateur
       â†“
CrÃ©er le document avec mise en forme
       â†“
Ajouter {{variables}}
       â†“
Sauvegarder en .docx
       â†“
Application â†’ "Importer Word"
       â†“
âœ… ModÃ¨le prÃªt Ã  Ãªtre utilisÃ©
```

### 2. GÃ©nÃ©rer un Courrier (Autant de Fois Que NÃ©cessaire)

```
Application â†’ "GÃ©nÃ©rer un Courrier"
       â†“
SÃ©lectionner un salariÃ©
       â†“
Choisir le modÃ¨le Word
       â†“
Remplir les variables personnalisÃ©es
       â†“
Cliquer "GÃ©nÃ©rer le Document Word"
       â†“
âœ… Fichier Word tÃ©lÃ©chargÃ© automatiquement
```

---

## Variables : 3 Types

### ğŸ”µ Variables SystÃ¨me (Auto-remplies)

```
Profil du salariÃ©                     Valeur dans le document
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Nom: DUPONT                     â†’     {{nom}} devient "DUPONT"
PrÃ©nom: Jean                    â†’     {{prenom}} devient "Jean"
Poste: Chauffeur                â†’     {{poste}} devient "Chauffeur"
Site: Paris CDG                 â†’     {{site_nom}} devient "Paris CDG"
Email: j.dupont@tca.fr          â†’     {{email}} devient "j.dupont@tca.fr"
```

**35 variables systÃ¨me disponibles !**

### ğŸŸ  Variables PersonnalisÃ©es (Ã€ Remplir)

```
RH saisit                             Valeur dans le document
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
date_reunion: 15/01/2025        â†’     {{date_reunion}} devient "15/01/2025"
motif: Entretien annuel         â†’     {{motif}} devient "Entretien annuel"
montant: 500                    â†’     {{montant}} devient "500"
```

### ğŸŸ¢ Variables Entreprise (Fixes)

```
Constantes                            Valeur dans le document
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                                â†’     {{nom_entreprise}} devient "TRANSPORT CLASSE AFFAIRE"
                                â†’     {{siret_entreprise}} devient "50426507500029"
                                â†’     {{tel_entreprise}} devient "01.86.22.24.00"
```

---

## Technologie UtilisÃ©e

### Fichier Word = Fichier ZIP

```
document.docx
â”‚
â”œâ”€â”€ [Content_Types].xml
â”œâ”€â”€ _rels/
â”‚   â””â”€â”€ .rels
â””â”€â”€ word/
    â”œâ”€â”€ document.xml          â† CONTENU DU TEXTE
    â”œâ”€â”€ styles.xml            â† STYLES ET MISE EN FORME
    â”œâ”€â”€ header1.xml           â† EN-TÃŠTE
    â”œâ”€â”€ footer1.xml           â† PIED DE PAGE
    â”œâ”€â”€ numbering.xml         â† NUMÃ‰ROTATION
    â””â”€â”€ media/
        â”œâ”€â”€ image1.png        â† LOGO
        â””â”€â”€ image2.jpg        â† AUTRES IMAGES
```

### Ce Que Fait Docxtemplater

```
1. Ouvrir le fichier .docx (ZIP)
        â†“
2. Lire word/document.xml
        â†“
3. Chercher <w:t>{{nom}}</w:t>
        â†“
4. Remplacer par <w:t>DUPONT</w:t>
        â†“
5. Sauvegarder le XML modifiÃ©
        â†“
6. RecrÃ©er le fichier .docx (ZIP)
```

**Tous les autres fichiers restent IDENTIQUES !**

---

## SÃ©curitÃ©

### Stockage des Fichiers

```
Supabase Storage
â”‚
â”œâ”€â”€ letter-templates/               â† ModÃ¨les originaux
â”‚   â”œâ”€â”€ CONVOCATION.docx
â”‚   â”œâ”€â”€ ATTESTATION.docx
â”‚   â””â”€â”€ CONFIRMATION.docx
â”‚
â””â”€â”€ generated-letters/              â† Documents gÃ©nÃ©rÃ©s
    â”œâ”€â”€ CONVOCATION_DUPONT_06-12-2025.docx
    â”œâ”€â”€ ATTESTATION_MARTIN_06-12-2025.docx
    â””â”€â”€ CONFIRMATION_BERNARD_06-12-2025.docx
```

### Permissions (RLS)

```
âœ… Utilisateurs authentifiÃ©s PEUVENT :
   - Uploader des modÃ¨les
   - Lire les modÃ¨les
   - GÃ©nÃ©rer des courriers
   - Lire les courriers gÃ©nÃ©rÃ©s

âŒ Utilisateurs authentifiÃ©s NE PEUVENT PAS :
   - AccÃ©der aux fichiers d'autres organisations
   - Modifier les modÃ¨les d'autres utilisateurs

âŒ Utilisateurs non authentifiÃ©s :
   - Aucun accÃ¨s
```

---

## Comparaison : Texte vs Word

### Template Texte â†’ PDF

```
ModÃ¨le texte simple
       â†“
GÃ©nÃ©ration PDF basique
       â†“
âœ… Rapide
âŒ Mise en forme limitÃ©e
âŒ Pas de logo
âŒ Pas de tableaux complexes
```

### Template Word â†’ Word

```
ModÃ¨le Word complet
       â†“
GÃ©nÃ©ration Word prÃ©servÃ©e
       â†“
âœ… Mise en forme complÃ¨te
âœ… Logo et images
âœ… Tableaux complexes
âœ… En-tÃªtes et pieds de page
âœ… Styles personnalisÃ©s
âœ… Ã‰ditable aprÃ¨s gÃ©nÃ©ration
```

---

## En RÃ©sumÃ©

### Ce Qui Est Fait

âœ… Code complet et testÃ©
âœ… Import de fichiers Word
âœ… DÃ©tection automatique des variables
âœ… GÃ©nÃ©ration avec prÃ©servation totale
âœ… TÃ©lÃ©chargement automatique

### Ce Qu'il Faut Faire

â¬œ ExÃ©cuter 2 migrations SQL (5 minutes)
â¬œ Tester avec un fichier Word (5 minutes)

### Ce Que Vous Obtenez

ğŸ¯ **Vos fichiers Word avec votre mise en forme**
ğŸ¯ **GÃ©nÃ©ration automatique en 1 clic**
ğŸ¯ **35+ variables auto-remplies**
ğŸ¯ **Documents professionnels identiques Ã  vos originaux**

---

## Navigation

ğŸ“– **Guides complets** : Voir `INDEX-WORD-TEMPLATES.md`

ğŸš€ **DÃ©marrage rapide** : Voir `START-HERE-WORD-TEMPLATES.md`

ğŸ’¡ **Ce fichier** : Vue d'ensemble visuelle

---

**Le systÃ¨me utilise VOTRE fichier Word ORIGINAL.**

**Il ne fait qu'un "Rechercher et Remplacer" automatisÃ©.**

**C'est tout !**
